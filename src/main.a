print "[CONSOLEOS] Starting consoleOS ...\n";

import lib/video.a
import lib/events.a
import lib/math.a

import lib/devices/input/time.a
import lib/utils/random.a
Random->var random = new(Random).construct(Time.unix());

import input.a
import registry.a
import desktop.a

print "[CONSOLEOS] User name is " ++ Consoleos_registry.fetch("user/name") ++ "\n";

var events = new(Events);
var ticks;

loop {
	Video.clear 0, 0, 0, 1.0;
	var fps = Video.fps();
	
	if ((ticks = ticks + 1) > 20) { // wait for framerate to stabilize
		desktop_draw 1.0, fps;
	}
	
	Video.flip();
	
	events.get();
	if (events.quit) break
}

return 0;
